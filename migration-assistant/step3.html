<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Step 3: Connect New Account - Website Migration Assistant</title>
  <link rel="stylesheet" href="css/style.css">
  <style>
    .summary-card {
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
      padding: 1.25rem;
      margin-bottom: 1.5rem;
    }
    .summary-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1rem;
    }
    .summary-icon {
      width: 40px;
      height: 40px;
      background: var(--primary-color);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
    }
    .summary-title {
      font-weight: 600;
      font-size: 1rem;
    }
    .summary-subtitle {
      font-size: 0.85rem;
      color: var(--text-secondary);
    }
    .summary-stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
      text-align: center;
    }
    .stat-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary-color);
    }
    .stat-label {
      font-size: 0.75rem;
      color: var(--text-secondary);
      text-transform: uppercase;
    }
    .site-list {
      max-height: 200px;
      overflow-y: auto;
      margin-top: 1rem;
    }
    .site-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem;
      background: white;
      border-radius: 4px;
      margin-bottom: 0.25rem;
      font-size: 0.9rem;
    }
    .site-item-icon {
      color: var(--success-color);
    }
    .connection-status {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      border-radius: var(--radius-md);
      margin-bottom: 1.5rem;
    }
    .connection-status.connected {
      background: #DCFCE7;
      color: var(--success-color);
    }
    .connection-status.pending {
      background: #FEF3C7;
      color: #B45309;
    }
    .connection-status.error {
      background: #FEE2E2;
      color: var(--error-color);
    }
    .credential-form {
      background: white;
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      padding: 1.5rem;
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="container">
      <div class="header-content">
        <a href="./" class="logo">
          <span class="logo-icon">üöÄ</span>
          Website Migration Assistant
        </a>
        <nav style="margin-left: auto;">
          <a href="../" style="color: white; text-decoration: none; padding: 8px 16px; background: rgba(255,255,255,0.2); border-radius: 6px;">‚Üê Toolkit Home</a>
        </nav>
      </div>
    </div>
  </header>

  <main class="main-content">
    <div class="container-sm">
      <!-- Progress Steps -->
      <div class="progress-steps">
        <div class="step completed">
          <div class="step-circle">‚úì</div>
          <span class="step-label">Old Account</span>
        </div>
        <div class="step completed">
          <div class="step-circle">‚úì</div>
          <span class="step-label">Select Sites</span>
        </div>
        <div class="step active">
          <div class="step-circle">3</div>
          <span class="step-label">New Account</span>
        </div>
        <div class="step">
          <div class="step-circle">4</div>
          <span class="step-label">Migrate</span>
        </div>
        <div class="step">
          <div class="step-circle">5</div>
          <span class="step-label">Emails</span>
        </div>
        <div class="step">
          <div class="step-circle">6</div>
          <span class="step-label">DNS</span>
        </div>
        <div class="step">
          <div class="step-circle">7</div>
          <span class="step-label">Complete</span>
        </div>
      </div>

      <!-- Migration Summary Card -->
      <div class="summary-card">
        <div class="summary-header">
          <div class="summary-icon">üì¶</div>
          <div>
            <div class="summary-title">Migration Summary</div>
            <div class="summary-subtitle">Sites ready for migration from your old account</div>
          </div>
        </div>
        <div class="summary-stats">
          <div>
            <div class="stat-value" id="sitesCount">0</div>
            <div class="stat-label">Sites Selected</div>
          </div>
          <div>
            <div class="stat-value" id="filesCount">0</div>
            <div class="stat-label">Files Downloaded</div>
          </div>
          <div>
            <div class="stat-value" id="totalSize">0 MB</div>
            <div class="stat-label">Total Size</div>
          </div>
        </div>
        <div class="site-list" id="siteList">
          <!-- Sites will be listed here -->
        </div>
      </div>

      <!-- Main Card -->
      <div class="card">
        <div class="card-header">
          <h1 class="card-title">Step 3: Connect to Your NEW Hostinger Account</h1>
          <p class="card-description">
            Enter the API token for your NEW Hostinger account where you want to migrate your sites.
          </p>
        </div>

        <div class="card-body">
          <!-- Alert Container -->
          <div id="alertContainer"></div>

          <!-- Connection Status -->
          <div id="connectionStatus" class="connection-status pending">
            <span>‚è≥</span>
            <span>Not connected - Enter your new account API token below</span>
          </div>

          <!-- Credential Form -->
          <div class="credential-form">
            <form id="newAccountForm">
              <div class="form-group">
                <label class="form-label form-label-required">New Hostinger API Token</label>
                <input type="password" id="newApiToken" name="newApiToken" class="form-input"
                       placeholder="Paste your NEW account API token" required>
                <small style="color: var(--text-tertiary);">
                  This must be a DIFFERENT account from your old one.
                  <a href="https://hpanel.hostinger.com/profile/api" target="_blank">Get API Token ‚Üí</a>
                </small>
              </div>

              <div style="padding: 1rem; background: #FEF3C7; border-radius: var(--radius-md); margin: 1rem 0;">
                <strong style="color: #B45309;">‚ö†Ô∏è Important:</strong>
                <ul style="margin: 0.5rem 0 0 1rem; padding: 0; font-size: 0.9rem; color: var(--text-secondary);">
                  <li>Use API token from your <strong>NEW</strong> Hostinger account</li>
                  <li>Make sure this account has enough hosting slots for your sites</li>
                  <li>Domains will be configured on the new account automatically</li>
                </ul>
              </div>

              <div class="form-group">
                <label class="form-label">FTP Credentials (for uploading)</label>
                <p class="form-help" style="margin-bottom: 0.75rem;">
                  FTP access is needed to upload your site files to the new account.
                </p>

                <div style="display: grid; gap: 1rem;">
                  <div>
                    <label class="form-label form-label-required" style="font-size: 0.85rem;">FTP Hostname</label>
                    <input type="text" id="newFtpHost" name="newFtpHost" class="form-input"
                           placeholder="e.g., ftp.yourdomain.com">
                  </div>
                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div>
                      <label class="form-label form-label-required" style="font-size: 0.85rem;">FTP Username</label>
                      <input type="text" id="newFtpUsername" name="newFtpUsername" class="form-input"
                             placeholder="FTP username">
                    </div>
                    <div>
                      <label class="form-label form-label-required" style="font-size: 0.85rem;">FTP Password</label>
                      <input type="password" id="newFtpPassword" name="newFtpPassword" class="form-input"
                             placeholder="FTP password">
                    </div>
                  </div>
                </div>
              </div>

              <button type="submit" class="btn btn-primary" id="connectBtn" style="width: 100%; margin-top: 1rem;">
                <span id="connectBtnIcon">üîå</span>
                <span id="connectBtnText">Connect & Verify Account</span>
              </button>
            </form>
          </div>

          <!-- Account Details (shown after connection) -->
          <div id="accountDetails" class="hidden" style="margin-top: 1.5rem;">
            <h3 style="font-size: 1rem; margin-bottom: 1rem;">New Account Details</h3>
            <div style="background: var(--bg-secondary); border-radius: var(--radius-md); padding: 1rem;">
              <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                <div>
                  <div style="font-size: 0.75rem; color: var(--text-secondary); text-transform: uppercase;">Account</div>
                  <div id="newAccountName" style="font-weight: 500;">-</div>
                </div>
                <div>
                  <div style="font-size: 0.75rem; color: var(--text-secondary); text-transform: uppercase;">Email</div>
                  <div id="newAccountEmail" style="font-weight: 500;">-</div>
                </div>
                <div>
                  <div style="font-size: 0.75rem; color: var(--text-secondary); text-transform: uppercase;">Hosting Slots</div>
                  <div id="newAccountSlots" style="font-weight: 500;">-</div>
                </div>
                <div>
                  <div style="font-size: 0.75rem; color: var(--text-secondary); text-transform: uppercase;">Available Space</div>
                  <div id="newAccountSpace" style="font-weight: 500;">-</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="card-footer">
          <a href="step2.html" class="btn btn-secondary">
            ‚Üê Back to Step 2
          </a>
          <button class="btn btn-primary" id="nextStepBtn" disabled>
            Next: Start Migration ‚Üí
          </button>
        </div>
      </div>

      <!-- Help Card -->
      <div class="card" style="margin-top: 1.5rem;">
        <div class="card-body">
          <h3 style="font-size: 1rem; margin-bottom: 0.75rem;">üí° How to get your NEW account API token</h3>
          <ol style="margin: 0; padding-left: 1.25rem; line-height: 1.8; color: var(--text-secondary);">
            <li>Log in to your <strong>NEW</strong> Hostinger account at <a href="https://hpanel.hostinger.com" target="_blank">hpanel.hostinger.com</a></li>
            <li>Click on your profile icon ‚Üí <strong>Account Settings</strong></li>
            <li>Go to <strong>API</strong> section</li>
            <li>Click <strong>Create New Token</strong></li>
            <li>Give it a name like "Migration Tool"</li>
            <li>Copy and paste the token above</li>
          </ol>
        </div>
      </div>
    </div>
  </main>

  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="loading-overlay hidden">
    <div class="loading-content">
      <div class="loading loading-lg" style="border-color: var(--border-color); border-top-color: var(--primary-color);"></div>
      <p id="loadingText" style="margin-top: 1rem; color: var(--text-secondary);">Connecting...</p>
    </div>
  </div>

  <script src="js/utils.js"></script>
  <script src="js/step3.js"></script>
</body>
</html>
