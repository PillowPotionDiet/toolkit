<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO Meta Tags -->
    <title>Free PDF Editor - 16 Tools: Merge, Split, Compress, Convert | PillowPotion</title>
    <meta name="description"
        content="Free online PDF editor with 16 powerful tools. Merge, split, compress, rotate, watermark, protect PDFs. Convert PDF to JPG, Word to PDF, OCR scanner. No signup required!">

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Free PDF Editor - 16 Tools: Merge, Split, Compress, Convert">
    <meta property="og:description"
        content="Complete PDF toolkit with 16 features. Merge, split, compress PDFs. Convert between formats. Add watermarks, signatures, passwords. All free, no limits.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://toolkit.pillowpotion.com/pdf-editor/">
    <meta property="og:image" content="https://pillowpotion.com/offers/pillowpotionlogo.webp">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Free PDF Editor - 16 Professional Tools">
    <meta name="twitter:description"
        content="Merge, split, compress, convert PDFs and more. 16 powerful tools, completely free, no signup required.">
    <meta name="twitter:image" content="https://pillowpotion.com/offers/pillowpotionlogo.webp">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://toolkit.pillowpotion.com/pdf-editor/">

    <!-- Favicon -->
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìÑ</text></svg>">

    <!-- Preload Critical Resources -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js" as="script">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js" as="script">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js" as="script">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js" as="script">

    <!-- Schema.org Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "PDF Editor Toolkit - 16 Features",
        "applicationCategory": "DesignApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "featureList": ["Merge PDF", "Split PDF", "Compress PDF", "PDF to Word", "Word to PDF", "JPG to PDF", "PDF to JPG", "Rotate PDF", "Protect PDF", "Unlock PDF", "Add Watermark", "Sign PDF", "Edit PDF", "OCR Scanner", "Organize Pages", "PDF to Excel"],
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.8",
            "ratingCount": "892"
        }
    }
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            background: #f8f9fa;
            color: #333;
            min-height: 100vh;
            margin: 0;
            padding: 0;
            position: relative;
            overflow-x: hidden;
        }

        /* Hero Background Animation */
        .hero-background-wrapper {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 0;
            pointer-events: none;
        }

        #particles-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }

        .hero-gradient-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg,
                rgba(102, 126, 234, 0.1) 0%,
                rgba(118, 75, 162, 0.1) 50%,
                rgba(240, 147, 251, 0.1) 100%);
            animation: gradientShift 15s ease infinite;
        }

        @keyframes gradientShift {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.8;
            }
        }

        .floating-shapes {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .shape {
            position: absolute;
            border-radius: 50%;
            filter: blur(40px);
            opacity: 0.8;
            animation: float 20s infinite ease-in-out;
        }

        .shape-1 {
            width: 350px;
            height: 350px;
            background: linear-gradient(135deg, #9bb0ff, #b88edb);
            top: 10%;
            left: 10%;
            animation-delay: 0s;
        }

        .shape-2 {
            width: 400px;
            height: 400px;
            background: linear-gradient(135deg, #ffc6fc, #ff94a8);
            top: 50%;
            right: 10%;
            animation-delay: 5s;
        }

        .shape-3 {
            width: 300px;
            height: 300px;
            background: linear-gradient(135deg, #8dd4ff, #5ff8ff);
            bottom: 20%;
            left: 20%;
            animation-delay: 10s;
        }

        .shape-4 {
            width: 350px;
            height: 350px;
            background: linear-gradient(135deg, #7fffb3, #6dffe8);
            bottom: 10%;
            right: 30%;
            animation-delay: 15s;
        }

        @keyframes float {
            0%, 100% {
                transform: translate(0, 0) scale(1);
            }
            33% {
                transform: translate(30px, -30px) scale(1.1);
            }
            66% {
                transform: translate(-20px, 20px) scale(0.9);
            }
        }

        .page-header {
            background: #ffffff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 100%;
            margin: 0;
        }

        .page-header .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .page-nav {
            display: flex;
            gap: 24px;
            align-items: center;
        }

        .page-nav a {
            color: #333;
            text-decoration: none;
            font-weight: 600;
            font-size: 15px;
            transition: all 0.3s;
            padding: 8px 12px;
            border-radius: 6px;
        }

        .page-nav a:hover {
            color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }

        .hero-section {
            text-align: center;
            padding: 40px 20px;
            position: relative;
            z-index: 1;
        }

        .hero-section h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #333;
        }

        .hero-section .subtitle {
            font-size: 1.1em;
            color: #666;
            margin-bottom: 30px;
        }

        .header {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            padding: 20px 0;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: none;
        }

        .header .subtitle {
            font-size: 1.2em;
            opacity: 0.95;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            position: relative;
            z-index: 1;
        }

        .tool-section {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.25);
            margin-bottom: 30px;
            position: relative;
            z-index: 1;
        }

        #toolSelector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .tool-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.25);
            position: relative;
        }

        .tool-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px 0 rgba(31, 38, 135, 0.25);
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .tool-card-icon {
            font-size: 3em;
            margin-bottom: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .tool-card:hover .tool-card-icon {
            transform: scale(1.15);
        }

        .tool-card-title {
            font-size: 1.2em;
            font-weight: 700;
            margin-bottom: 8px;
            color: #333;
            text-align: center;
            text-shadow: none;
        }

        .tool-card-desc {
            font-size: 0.9em;
            color: #666;
            text-align: center;
            margin-bottom: 10px;
            line-height: 1.5;
            text-shadow: none;
        }

        #toolWorkspace {
            display: none;
        }

        .workspace-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }

        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .back-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .workspace-title {
            font-size: 1.8em;
            color: #333;
            font-weight: 700;
            text-shadow: none;
        }

        .upload-zone {
            border: 3px dashed rgba(102, 126, 234, 0.5);
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(15px);
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 20px;
        }

        .upload-zone:hover {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(118, 75, 162, 0.7);
        }

        .upload-zone.dragover {
            background: rgba(102, 126, 234, 0.15);
            border-color: rgba(118, 75, 162, 0.9);
            transform: scale(1.02);
        }

        .upload-zone input[type="file"] {
            display: none;
        }

        .upload-icon {
            font-size: 4em;
            margin-bottom: 10px;
        }

        .upload-text {
            font-size: 1.1em;
            color: #667eea;
            font-weight: 600;
            margin-bottom: 8px;
            text-shadow: none;
        }

        .upload-hint {
            font-size: 0.9em;
            color: #666;
            text-shadow: none;
        }

        .file-list {
            margin: 20px 0;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 10px;
            margin-bottom: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .file-icon {
            font-size: 1.5em;
        }

        .file-name {
            font-weight: 600;
            color: #333;
            text-shadow: none;
        }

        .file-size {
            color: #666;
            font-size: 0.9em;
            text-shadow: none;
        }

        .file-remove {
            background: #ff4757;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 6px 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .file-remove:hover {
            background: #ee5a6f;
        }

        .page-thumbnails {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .page-thumbnail {
            position: relative;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .page-thumbnail:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
            background: rgba(255, 255, 255, 0.15);
        }

        .page-thumbnail.selected {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.2);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .page-thumbnail canvas {
            width: 100%;
            height: auto;
            border-radius: 6px;
        }

        .page-number {
            text-align: center;
            margin-top: 8px;
            font-size: 0.85em;
            font-weight: 600;
            color: #666;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        button {
            padding: 15px 30px;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            flex: 1;
        }

        .primary-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .secondary-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .success-btn {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }

        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        button:disabled {
            background: #ccc !important;
            cursor: not-allowed;
            transform: none;
        }

        .progress-container {
            margin: 20px 0;
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.9em;
        }

        .progress-text {
            margin-top: 10px;
            text-align: center;
            color: #666;
            font-size: 0.9em;
        }

        .info-box {
            padding: 15px 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid;
            backdrop-filter: blur(15px);
        }

        .info-box.warning {
            background: rgba(255, 193, 7, 0.15);
            border-color: #ffc107;
            color: #856404;
        }

        .info-box.info {
            background: rgba(13, 202, 240, 0.15);
            border-color: #0dcaf0;
            color: #055160;
        }

        .info-box.error {
            background: rgba(220, 53, 69, 0.15);
            border-color: #dc3545;
            color: #721c24;
        }

        .info-box.success {
            background: rgba(25, 135, 84, 0.15);
            border-color: #198754;
            color: #0f5132;
        }

        .tool-settings {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .setting-group {
            margin-bottom: 20px;
        }

        .setting-group:last-child {
            margin-bottom: 0;
        }

        .setting-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .setting-input {
            width: 100%;
            padding: 10px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.05);
            color: #ffffff;
        }

        .setting-input:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255, 255, 255, 0.1);
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        .radio-group {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .radio-group label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            color: #333;
        }

        .results-section {
            margin-top: 30px;
            display: none;
        }

        .result-item {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .result-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .result-details {
            flex: 1;
        }

        .result-name {
            font-weight: 700;
            font-size: 1.1em;
            color: #333;
            margin-bottom: 5px;
        }

        .result-stats {
            color: #666;
            font-size: 0.9em;
        }

        .download-btn {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
            padding: 10px 25px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .loading-content {
            background: white;
            padding: 40px;
            border-radius: 12px;
            text-align: center;
            max-width: 400px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .loading-text {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
        }

        @media (max-width: 768px) {
            body {
                padding: 0;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .header .subtitle {
                font-size: 1em;
            }

            #toolSelector {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
            }

            .tool-card {
                padding: 20px;
                background: rgba(255, 255, 255, 0.12);
            }

            .tool-card-icon {
                width: 50px;
                height: 50px;
            }

            .tools-nav {
                flex-direction: column;
                gap: 10px;
                padding: 0 20px;
            }

            .tools-nav a {
                width: 100%;
                text-align: center;
            }

            .action-buttons {
                flex-direction: column;
            }

            button {
                padding: 12px 20px;
                font-size: 14px;
            }

            .workspace-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }

            .page-thumbnails {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                gap: 10px;
            }
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>

<body>
    <!-- Hero Background -->
    <div class="hero-background-wrapper">
        <canvas id="particles-canvas"></canvas>
        <div class="hero-gradient-overlay"></div>
        <div class="floating-shapes">
            <div class="shape shape-1"></div>
            <div class="shape shape-2"></div>
            <div class="shape shape-3"></div>
            <div class="shape shape-4"></div>
        </div>
    </div>

    <!-- Header -->
    <header class="page-header">
        <div class="container">
            <div class="logo">
                <a href="../" style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 12px;">
                    <img src="https://pillowpotion.com/offers/pillowpotionlogo.webp" alt="PillowPotion Logo" style="height: 40px; width: auto; display: block;" onerror="this.style.display='none'">
                    <span class="logo-text" style="font-size: 20px; font-weight: 700; color: #333;">PDF Editor</span>
                </a>
            </div>
            <nav class="page-nav">
                <a href="../">‚Üê Toolkit Home</a>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero-section">
        <h1>Free PDF Editor - 16 Powerful Tools</h1>
        <p class="subtitle">Merge, Split, Compress, Convert & More - All Client-Side Processing</p>
    </section>

    <div class="container">
        <div id="toolSelector" class="tool-section">
            <div class="tool-card" data-tool="merge">
                <div class="tool-card-icon">üìë</div>
                <div class="tool-card-title">Merge PDF</div>
                <div class="tool-card-desc">Combine multiple PDF files into one</div>
            </div>

            <div class="tool-card" data-tool="split">
                <div class="tool-card-icon">‚úÇÔ∏è</div>
                <div class="tool-card-title">Split PDF</div>
                <div class="tool-card-desc">Extract pages from PDF files</div>
            </div>

            <div class="tool-card" data-tool="compress">
                <div class="tool-card-icon">üóúÔ∏è</div>
                <div class="tool-card-title">Compress PDF</div>
                <div class="tool-card-desc">Reduce PDF file size</div>
            </div>

            <div class="tool-card" data-tool="pdf-to-word">
                <div class="tool-card-icon">üìÑ</div>
                <div class="tool-card-title">PDF to Word</div>
                <div class="tool-card-desc">Convert PDF to DOCX format</div>
            </div>

            <div class="tool-card" data-tool="word-to-pdf">
                <div class="tool-card-icon">üìù</div>
                <div class="tool-card-title">Word to PDF</div>
                <div class="tool-card-desc">Convert DOCX to PDF format</div>
            </div>

            <div class="tool-card" data-tool="jpg-to-pdf">
                <div class="tool-card-icon">üñºÔ∏è</div>
                <div class="tool-card-title">JPG to PDF</div>
                <div class="tool-card-desc">Convert images to PDF</div>
            </div>

            <div class="tool-card" data-tool="pdf-to-jpg">
                <div class="tool-card-icon">üé®</div>
                <div class="tool-card-title">PDF to JPG</div>
                <div class="tool-card-desc">Convert PDF pages to images</div>
            </div>

            <div class="tool-card" data-tool="rotate">
                <div class="tool-card-icon">üîÑ</div>
                <div class="tool-card-title">Rotate PDF</div>
                <div class="tool-card-desc">Rotate PDF pages</div>
            </div>

            <div class="tool-card" data-tool="protect">
                <div class="tool-card-icon">üîí</div>
                <div class="tool-card-title">Protect PDF</div>
                <div class="tool-card-desc">Add password protection</div>
            </div>

            <div class="tool-card" data-tool="unlock">
                <div class="tool-card-icon">üîì</div>
                <div class="tool-card-title">Unlock PDF</div>
                <div class="tool-card-desc">Remove password protection</div>
            </div>

            <div class="tool-card" data-tool="watermark">
                <div class="tool-card-icon">üíß</div>
                <div class="tool-card-title">Add Watermark</div>
                <div class="tool-card-desc">Add text watermark to PDF</div>
            </div>

            <div class="tool-card" data-tool="sign">
                <div class="tool-card-icon">‚úçÔ∏è</div>
                <div class="tool-card-title">Sign PDF</div>
                <div class="tool-card-desc">Add digital signature</div>
            </div>

            <div class="tool-card" data-tool="edit">
                <div class="tool-card-icon">‚úèÔ∏è</div>
                <div class="tool-card-title">Edit PDF</div>
                <div class="tool-card-desc">Add text and content to PDF</div>
            </div>

            <div class="tool-card" data-tool="ocr">
                <div class="tool-card-icon">üîç</div>
                <div class="tool-card-title">OCR Scanner</div>
                <div class="tool-card-desc">Extract text from scanned PDF</div>
            </div>

            <div class="tool-card" data-tool="organize">
                <div class="tool-card-icon">üìã</div>
                <div class="tool-card-title">Organize Pages</div>
                <div class="tool-card-desc">Reorder, delete, or duplicate pages</div>
            </div>

            <div class="tool-card" data-tool="pdf-to-excel">
                <div class="tool-card-icon">üìä</div>
                <div class="tool-card-title">PDF to Excel</div>
                <div class="tool-card-desc">Extract tables to Excel</div>
            </div>
        </div>

        <div id="toolWorkspace" class="tool-section">
            <div class="workspace-header">
                <button class="back-btn" id="backToTools">‚Üê Back to Tools</button>
                <h2 class="workspace-title" id="workspaceTitle">Tool Name</h2>
            </div>

            <div id="toolContent"></div>

            <div class="progress-container" id="progressContainer">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill">0%</div>
                </div>
                <div class="progress-text" id="progressText">Processing...</div>
            </div>

            <div class="results-section" id="resultsSection"></div>
        </div>
    </div>

    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <div class="loading-text" id="loadingText">Loading libraries...</div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <script>
        const CONFIG = {
            maxFileSize: 50 * 1024 * 1024,
            maxFilesPerOperation: 20,
            supportedFormats: {
                pdf: ['application/pdf'],
                images: ['image/jpeg', 'image/png', 'image/webp', 'image/jpg'],
                documents: ['application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'application/msword']
            },
            libraryUrls: {
                'pdf-lib': 'https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js',
                'pdfjs': 'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js',
                'pdfjs-worker': 'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.worker.min.js',
                'jspdf': 'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js',
                'tesseract': 'https://cdn.jsdelivr.net/npm/tesseract.js@4.1.1/dist/tesseract.min.js',
                'xlsx': 'https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js',
                'mammoth': 'https://cdn.jsdelivr.net/npm/mammoth@1.6.0/mammoth.browser.min.js',
                'docx': 'https://cdn.jsdelivr.net/npm/docx@7.8.2/build/index.js'
            }
        };

        const LIBRARY_MAP = {
            'merge': ['pdf-lib'],
            'split': ['pdf-lib', 'pdfjs'],
            'compress': ['pdf-lib'],
            'pdf-to-word': ['pdfjs'],
            'word-to-pdf': ['jspdf'],
            'jpg-to-pdf': ['jspdf'],
            'pdf-to-jpg': ['pdfjs'],
            'rotate': ['pdf-lib', 'pdfjs'],
            'protect': ['pdf-lib'],
            'unlock': ['pdf-lib'],
            'watermark': ['pdf-lib'],
            'sign': ['pdf-lib'],
            'edit': ['pdf-lib', 'pdfjs'],
            'ocr': ['pdfjs', 'tesseract'],
            'organize': ['pdf-lib', 'pdfjs'],
            'pdf-to-excel': ['pdfjs', 'xlsx']
        };

        const LibraryLoader = {
            loaded: new Set(),

            async load(libraryName) {
                if (this.loaded.has(libraryName)) return true;

                return new Promise((resolve, reject) => {
                    const script = document.createElement('script');
                    script.src = CONFIG.libraryUrls[libraryName];
                    script.onload = () => {
                        this.loaded.add(libraryName);

                        if (libraryName === 'pdfjs') {
                            pdfjsLib.GlobalWorkerOptions.workerSrc = CONFIG.libraryUrls['pdfjs-worker'];
                        }

                        resolve(true);
                    };
                    script.onerror = () => reject(new Error(`Failed to load ${libraryName}`));
                    document.head.appendChild(script);
                });
            },

            async loadMultiple(libraryNames) {
                const promises = libraryNames.map(name => this.load(name));
                return Promise.all(promises);
            }
        };

        const UIManager = {
            currentTool: null,

            showToolSelector() {
                document.getElementById('toolSelector').style.display = 'grid';
                document.getElementById('toolWorkspace').style.display = 'none';
                this.currentTool = null;
            },

            async activateTool(toolName) {
                this.showLoading(`Loading ${toolName} tool...`);

                try {
                    const libraries = LIBRARY_MAP[toolName];
                    if (libraries) {
                        await LibraryLoader.loadMultiple(libraries);
                    }

                    document.getElementById('toolSelector').style.display = 'none';
                    document.getElementById('toolWorkspace').style.display = 'block';

                    this.resetWorkspace();

                    this.currentTool = toolName;
                    Tools[toolName].init();

                    this.hideLoading();
                } catch (error) {
                    console.error('Error activating tool:', error);
                    alert('Failed to load tool. Please try again.');
                    this.hideLoading();
                    this.showToolSelector();
                }
            },

            resetWorkspace() {
                document.getElementById('toolContent').innerHTML = '';
                document.getElementById('resultsSection').style.display = 'none';
                document.getElementById('resultsSection').innerHTML = '';
                Utils.hideProgress();
            },

            showLoading(text) {
                document.getElementById('loadingOverlay').style.display = 'flex';
                document.getElementById('loadingText').textContent = text;
            },

            hideLoading() {
                document.getElementById('loadingOverlay').style.display = 'none';
            }
        };

        const Utils = {
            formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
            },

            generateUniqueId() {
                return Date.now().toString(36) + Math.random().toString(36).substr(2);
            },

            async fileToArrayBuffer(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = () => resolve(reader.result);
                    reader.onerror = reject;
                    reader.readAsArrayBuffer(file);
                });
            },

            async fileToDataURL(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = () => resolve(reader.result);
                    reader.onerror = reject;
                    reader.readAsDataURL(file);
                });
            },

            showProgress(percentage, message) {
                const container = document.getElementById('progressContainer');
                const fill = document.getElementById('progressFill');
                const text = document.getElementById('progressText');

                container.style.display = 'block';
                fill.style.width = percentage + '%';
                fill.textContent = Math.round(percentage) + '%';
                text.textContent = message || 'Processing...';
            },

            hideProgress() {
                document.getElementById('progressContainer').style.display = 'none';
            },

            downloadFile(blob, filename) {
                saveAs(blob, filename);
            },

            validateFile(file, type = 'pdf') {
                const formats = CONFIG.supportedFormats[type];
                if (!formats.includes(file.type)) {
                    alert(`Invalid file type. Expected: ${type.toUpperCase()}`);
                    return false;
                }

                if (file.size > CONFIG.maxFileSize) {
                    alert(`File too large. Maximum size: ${this.formatFileSize(CONFIG.maxFileSize)}`);
                    return false;
                }

                return true;
            },

            showError(message) {
                const content = document.getElementById('toolContent');
                const errorBox = document.createElement('div');
                errorBox.className = 'info-box error';
                errorBox.innerHTML = `<strong>Error:</strong> ${message}`;
                content.insertBefore(errorBox, content.firstChild);

                setTimeout(() => errorBox.remove(), 5000);
            },

            showSuccess(message) {
                const content = document.getElementById('toolContent');
                const successBox = document.createElement('div');
                successBox.className = 'info-box success';
                successBox.innerHTML = `<strong>Success!</strong> ${message}`;
                content.insertBefore(successBox, content.firstChild);

                setTimeout(() => successBox.remove(), 5000);
            },

            async renderPDFThumbnail(pdfData, pageNum, canvas, scale = 1.0) {
                const pdf = await pdfjsLib.getDocument({ data: pdfData }).promise;
                const page = await pdf.getPage(pageNum);
                const viewport = page.getViewport({ scale });

                canvas.width = viewport.width;
                canvas.height = viewport.height;

                const context = canvas.getContext('2d');
                await page.render({ canvasContext: context, viewport }).promise;
            }
        };

        const Tools = {
            'merge': {
                files: [],

                init() {
                    document.getElementById('workspaceTitle').textContent = 'Merge PDF Files';

                    const html = `
                        <div class="info-box info">
                            <strong>How it works:</strong> Upload multiple PDF files and combine them into a single PDF document.
                        </div>

                        <div class="upload-zone" id="mergeUploadZone">
                            <input type="file" id="mergeFileInput" accept=".pdf" multiple>
                            <div class="upload-icon">üìÅ</div>
                            <div class="upload-text">Drop PDF files here or click to browse</div>
                            <div class="upload-hint">Upload up to 20 PDF files ‚Ä¢ Max 50MB each</div>
                        </div>

                        <div class="file-list" id="mergeFileList"></div>

                        <div class="action-buttons">
                            <button class="primary-btn" id="mergeBtn" disabled>Merge PDFs</button>
                        </div>
                    `;

                    document.getElementById('toolContent').innerHTML = html;

                    const uploadZone = document.getElementById('mergeUploadZone');
                    const fileInput = document.getElementById('mergeFileInput');

                    uploadZone.addEventListener('click', () => fileInput.click());
                    fileInput.addEventListener('change', (e) => this.handleFiles(e.target.files));

                    uploadZone.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        uploadZone.classList.add('dragover');
                    });

                    uploadZone.addEventListener('dragleave', () => {
                        uploadZone.classList.remove('dragover');
                    });

                    uploadZone.addEventListener('drop', (e) => {
                        e.preventDefault();
                        uploadZone.classList.remove('dragover');
                        this.handleFiles(e.dataTransfer.files);
                    });

                    document.getElementById('mergeBtn').addEventListener('click', () => this.merge());
                },

                handleFiles(fileList) {
                    const validFiles = Array.from(fileList).filter(file => Utils.validateFile(file, 'pdf'));

                    if (this.files.length + validFiles.length > CONFIG.maxFilesPerOperation) {
                        alert(`Maximum ${CONFIG.maxFilesPerOperation} files allowed`);
                        return;
                    }

                    this.files.push(...validFiles);
                    this.renderFileList();
                },

                renderFileList() {
                    const listEl = document.getElementById('mergeFileList');
                    const mergeBtn = document.getElementById('mergeBtn');

                    if (this.files.length === 0) {
                        listEl.innerHTML = '';
                        mergeBtn.disabled = true;
                        return;
                    }

                    mergeBtn.disabled = false;

                    listEl.innerHTML = this.files.map((file, index) => `
                        <div class="file-item" data-index="${index}">
                            <div class="file-info">
                                <div class="file-icon">üìÑ</div>
                                <div>
                                    <div class="file-name">${file.name}</div>
                                    <div class="file-size">${Utils.formatFileSize(file.size)}</div>
                                </div>
                            </div>
                            <button class="file-remove" onclick="Tools.merge.removeFile(${index})">Remove</button>
                        </div>
                    `).join('');
                },

                removeFile(index) {
                    this.files.splice(index, 1);
                    this.renderFileList();
                },

                async merge() {
                    if (this.files.length < 2) {
                        alert('Please upload at least 2 PDF files to merge');
                        return;
                    }

                    try {
                        UIManager.showLoading('Merging PDFs...');
                        Utils.showProgress(0, 'Starting merge process...');

                        const { PDFDocument } = PDFLib;
                        const mergedPdf = await PDFDocument.create();

                        for (let i = 0; i < this.files.length; i++) {
                            const progress = ((i + 1) / this.files.length) * 100;
                            Utils.showProgress(progress, `Merging file ${i + 1} of ${this.files.length}...`);

                            const arrayBuffer = await Utils.fileToArrayBuffer(this.files[i]);
                            const pdf = await PDFDocument.load(arrayBuffer);
                            const copiedPages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
                            copiedPages.forEach(page => mergedPdf.addPage(page));
                        }

                        Utils.showProgress(100, 'Saving merged PDF...');
                        const mergedPdfBytes = await mergedPdf.save();
                        const blob = new Blob([mergedPdfBytes], { type: 'application/pdf' });

                        const resultsSection = document.getElementById('resultsSection');
                        resultsSection.style.display = 'block';
                        resultsSection.innerHTML = `
                            <div class="result-item">
                                <div class="result-info">
                                    <div class="result-details">
                                        <div class="result-name">merged-document.pdf</div>
                                        <div class="result-stats">
                                            ${this.files.length} files merged ‚Ä¢ ${Utils.formatFileSize(blob.size)}
                                        </div>
                                    </div>
                                    <button class="download-btn" onclick="Tools.merge.downloadResult()">Download PDF</button>
                                </div>
                            </div>
                        `;

                        this.resultBlob = blob;
                        Utils.showSuccess('PDFs merged successfully!');
                        UIManager.hideLoading();
                        Utils.hideProgress();

                    } catch (error) {
                        console.error('Merge error:', error);
                        Utils.showError('Failed to merge PDFs. Please try again.');
                        UIManager.hideLoading();
                        Utils.hideProgress();
                    }
                },

                downloadResult() {
                    if (this.resultBlob) {
                        Utils.downloadFile(this.resultBlob, 'merged-document.pdf');
                    }
                }
            },

            'split': {
                currentFile: null,
                pdfData: null,
                selectedPages: new Set(),
                totalPages: 0,

                init() {
                    this.currentFile = null;
                    this.pdfData = null;
                    this.selectedPages = new Set();
                    this.totalPages = 0;

                    document.getElementById('workspaceTitle').textContent = 'Split PDF';
                    document.getElementById('toolContent').innerHTML = `
                        <div class="info-box info">
                            <strong>How it works:</strong> Upload a PDF, select the pages you want to extract, and create a new PDF with only those pages.
                        </div>

                        <div class="upload-zone" id="splitUploadZone">
                            <input type="file" id="splitFileInput" accept=".pdf">
                            <div class="upload-icon">üìÅ</div>
                            <div class="upload-text">Drop PDF file here or click to browse</div>
                            <div class="upload-hint">Upload a PDF file ‚Ä¢ Max 50MB</div>
                        </div>

                        <div class="file-list" id="splitFileList"></div>
                        <div id="splitPagesContainer" style="display: none;">
                            <div style="margin: 20px 0; display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                                <button class="secondary-btn" style="flex: 0 0 auto; padding: 10px 20px;" onclick="Tools.split.selectAll()">Select All</button>
                                <button class="secondary-btn" style="flex: 0 0 auto; padding: 10px 20px;" onclick="Tools.split.deselectAll()">Deselect All</button>
                                <span id="selectionCount" style="color: #666; font-weight: 600;"></span>
                            </div>
                            <div class="page-thumbnails" id="splitPageThumbnails"></div>
                            <div class="action-buttons">
                                <button class="primary-btn" id="extractBtn" disabled>Extract Selected Pages</button>
                            </div>
                        </div>
                    `;

                    const uploadZone = document.getElementById('splitUploadZone');
                    const fileInput = document.getElementById('splitFileInput');

                    uploadZone.addEventListener('click', () => fileInput.click());
                    fileInput.addEventListener('change', (e) => this.handleFile(e.target.files[0]));

                    uploadZone.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        uploadZone.classList.add('dragover');
                    });

                    uploadZone.addEventListener('dragleave', () => {
                        uploadZone.classList.remove('dragover');
                    });

                    uploadZone.addEventListener('drop', (e) => {
                        e.preventDefault();
                        uploadZone.classList.remove('dragover');
                        if (e.dataTransfer.files.length > 0) {
                            this.handleFile(e.dataTransfer.files[0]);
                        }
                    });

                    document.getElementById('extractBtn').addEventListener('click', () => this.extractPages());
                },

                async handleFile(file) {
                    if (!file || !Utils.validateFile(file, 'pdf')) return;

                    this.currentFile = file;
                    UIManager.showLoading('Loading PDF pages...');

                    try {
                        this.pdfData = await Utils.fileToArrayBuffer(file);
                        const pdf = await pdfjsLib.getDocument({ data: this.pdfData }).promise;
                        this.totalPages = pdf.numPages;

                        document.getElementById('splitFileList').innerHTML = `
                            <div class="file-item">
                                <div class="file-info">
                                    <div class="file-icon">üìÑ</div>
                                    <div>
                                        <div class="file-name">${file.name}</div>
                                        <div class="file-size">${Utils.formatFileSize(file.size)} ‚Ä¢ ${this.totalPages} pages</div>
                                    </div>
                                </div>
                            </div>
                        `;

                        await this.renderThumbnails();
                        document.getElementById('splitPagesContainer').style.display = 'block';
                        UIManager.hideLoading();

                    } catch (error) {
                        console.error('Error loading PDF:', error);
                        Utils.showError('Failed to load PDF. Please try again.');
                        UIManager.hideLoading();
                    }
                },

                async renderThumbnails() {
                    const container = document.getElementById('splitPageThumbnails');
                    container.innerHTML = '';

                    for (let i = 1; i <= this.totalPages; i++) {
                        const thumbnail = document.createElement('div');
                        thumbnail.className = 'page-thumbnail';
                        thumbnail.innerHTML = `
                            <canvas></canvas>
                            <div class="page-number">Page ${i}</div>
                        `;

                        thumbnail.addEventListener('click', () => this.togglePage(i, thumbnail));
                        container.appendChild(thumbnail);

                        const canvas = thumbnail.querySelector('canvas');
                        await Utils.renderPDFThumbnail(this.pdfData, i, canvas, 0.5);
                    }
                },

                togglePage(pageNum, element) {
                    if (this.selectedPages.has(pageNum)) {
                        this.selectedPages.delete(pageNum);
                        element.classList.remove('selected');
                    } else {
                        this.selectedPages.add(pageNum);
                        element.classList.add('selected');
                    }

                    this.updateSelectionCount();
                },

                selectAll() {
                    this.selectedPages.clear();
                    for (let i = 1; i <= this.totalPages; i++) {
                        this.selectedPages.add(i);
                    }
                    document.querySelectorAll('.page-thumbnail').forEach(el => el.classList.add('selected'));
                    this.updateSelectionCount();
                },

                deselectAll() {
                    this.selectedPages.clear();
                    document.querySelectorAll('.page-thumbnail').forEach(el => el.classList.remove('selected'));
                    this.updateSelectionCount();
                },

                updateSelectionCount() {
                    const count = this.selectedPages.size;
                    document.getElementById('selectionCount').textContent =
                        count > 0 ? `${count} page${count > 1 ? 's' : ''} selected` : 'No pages selected';
                    document.getElementById('extractBtn').disabled = count === 0;
                },

                async extractPages() {
                    if (this.selectedPages.size === 0) {
                        alert('Please select at least one page to extract');
                        return;
                    }

                    try {
                        UIManager.showLoading('Extracting pages...');
                        Utils.showProgress(0, 'Creating new PDF...');

                        const { PDFDocument } = PDFLib;
                        const sourcePdf = await PDFDocument.load(this.pdfData);
                        const newPdf = await PDFDocument.create();

                        const sortedPages = Array.from(this.selectedPages).sort((a, b) => a - b);

                        for (let i = 0; i < sortedPages.length; i++) {
                            const progress = ((i + 1) / sortedPages.length) * 100;
                            Utils.showProgress(progress, `Extracting page ${i + 1} of ${sortedPages.length}...`);

                            const [copiedPage] = await newPdf.copyPages(sourcePdf, [sortedPages[i] - 1]);
                            newPdf.addPage(copiedPage);
                        }

                        Utils.showProgress(100, 'Saving PDF...');
                        const pdfBytes = await newPdf.save();
                        const blob = new Blob([pdfBytes], { type: 'application/pdf' });

                        const resultsSection = document.getElementById('resultsSection');
                        resultsSection.style.display = 'block';
                        resultsSection.innerHTML = `
                            <div class="result-item">
                                <div class="result-info">
                                    <div class="result-details">
                                        <div class="result-name">extracted-pages.pdf</div>
                                        <div class="result-stats">
                                            ${sortedPages.length} page${sortedPages.length > 1 ? 's' : ''} extracted ‚Ä¢ ${Utils.formatFileSize(blob.size)}
                                        </div>
                                    </div>
                                    <button class="download-btn" onclick="Tools.split.downloadResult()">Download PDF</button>
                                </div>
                            </div>
                        `;

                        this.resultBlob = blob;
                        Utils.showSuccess('Pages extracted successfully!');
                        UIManager.hideLoading();
                        Utils.hideProgress();

                    } catch (error) {
                        console.error('Extract error:', error);
                        Utils.showError('Failed to extract pages. Please try again.');
                        UIManager.hideLoading();
                        Utils.hideProgress();
                    }
                },

                downloadResult() {
                    if (this.resultBlob) {
                        Utils.downloadFile(this.resultBlob, 'extracted-pages.pdf');
                    }
                }
            },

            'compress': {
                currentFile: null,

                init() {
                    this.currentFile = null;

                    document.getElementById('workspaceTitle').textContent = 'Compress PDF';
                    document.getElementById('toolContent').innerHTML = `
                        <div class="info-box warning">
                            <strong>Client-side compression:</strong> Removes metadata and optimizes structure (typically 5-15% reduction). For maximum compression with image optimization, use server-based tools.
                        </div>

                        <div class="upload-zone" id="compressUploadZone">
                            <input type="file" id="compressFileInput" accept=".pdf">
                            <div class="upload-icon">üìÅ</div>
                            <div class="upload-text">Drop PDF file here or click to browse</div>
                            <div class="upload-hint">Upload a PDF file ‚Ä¢ Max 50MB</div>
                        </div>

                        <div class="file-list" id="compressFileList"></div>

                        <div class="action-buttons" id="compressActions" style="display: none;">
                            <button class="primary-btn" id="compressBtn">Compress PDF</button>
                        </div>
                    `;

                    const uploadZone = document.getElementById('compressUploadZone');
                    const fileInput = document.getElementById('compressFileInput');

                    uploadZone.addEventListener('click', () => fileInput.click());
                    fileInput.addEventListener('change', (e) => this.handleFile(e.target.files[0]));

                    uploadZone.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        uploadZone.classList.add('dragover');
                    });

                    uploadZone.addEventListener('dragleave', () => {
                        uploadZone.classList.remove('dragover');
                    });

                    uploadZone.addEventListener('drop', (e) => {
                        e.preventDefault();
                        uploadZone.classList.remove('dragover');
                        if (e.dataTransfer.files.length > 0) {
                            this.handleFile(e.dataTransfer.files[0]);
                        }
                    });

                    document.getElementById('compressBtn').addEventListener('click', () => this.compress());
                },

                handleFile(file) {
                    if (!file || !Utils.validateFile(file, 'pdf')) return;

                    this.currentFile = file;

                    document.getElementById('compressFileList').innerHTML = `
                        <div class="file-item">
                            <div class="file-info">
                                <div class="file-icon">üìÑ</div>
                                <div>
                                    <div class="file-name">${file.name}</div>
                                    <div class="file-size">${Utils.formatFileSize(file.size)}</div>
                                </div>
                            </div>
                        </div>
                    `;

                    document.getElementById('compressActions').style.display = 'flex';
                },

                async compress() {
                    if (!this.currentFile) return;

                    try {
                        UIManager.showLoading('Compressing PDF...');
                        Utils.showProgress(0, 'Loading PDF...');

                        const originalSize = this.currentFile.size;
                        const arrayBuffer = await Utils.fileToArrayBuffer(this.currentFile);

                        Utils.showProgress(30, 'Analyzing PDF structure...');
                        const { PDFDocument } = PDFLib;
                        const pdfDoc = await PDFDocument.load(arrayBuffer);

                        // Remove metadata to reduce size
                        Utils.showProgress(50, 'Removing metadata...');
                        pdfDoc.setTitle('');
                        pdfDoc.setAuthor('');
                        pdfDoc.setSubject('');
                        pdfDoc.setKeywords([]);
                        pdfDoc.setProducer('');
                        pdfDoc.setCreator('');

                        Utils.showProgress(70, 'Optimizing structure...');
                        // Save with optimization
                        const compressedBytes = await pdfDoc.save({
                            useObjectStreams: false,
                            addDefaultPage: false,
                            objectsPerTick: 50
                        });

                        Utils.showProgress(100, 'Finalizing...');
                        const blob = new Blob([compressedBytes], { type: 'application/pdf' });
                        const compressedSize = blob.size;
                        const reduction = ((originalSize - compressedSize) / originalSize * 100).toFixed(1);

                        const resultsSection = document.getElementById('resultsSection');
                        resultsSection.style.display = 'block';
                        resultsSection.innerHTML = `
                            <div class="result-item">
                                <div class="result-info">
                                    <div class="result-details">
                                        <div class="result-name">compressed-${this.currentFile.name}</div>
                                        <div class="result-stats">
                                            Original: ${Utils.formatFileSize(originalSize)} ‚Üí Compressed: ${Utils.formatFileSize(compressedSize)}
                                            <br>
                                            <strong style="color: #43e97b;">Reduced by ${reduction}%</strong>
                                        </div>
                                    </div>
                                    <button class="download-btn" onclick="Tools.compress.downloadResult()">Download PDF</button>
                                </div>
                            </div>
                        `;

                        this.resultBlob = blob;
                        Utils.showSuccess(`PDF compressed successfully! Reduced by ${reduction}%`);
                        UIManager.hideLoading();
                        Utils.hideProgress();

                    } catch (error) {
                        console.error('Compression error:', error);
                        Utils.showError('Failed to compress PDF. Please try again.');
                        UIManager.hideLoading();
                        Utils.hideProgress();
                    }
                },

                downloadResult() {
                    if (this.resultBlob && this.currentFile) {
                        Utils.downloadFile(this.resultBlob, `compressed-${this.currentFile.name}`);
                    }
                }
            },

            'pdf-to-word': {
                init() {
                    document.getElementById('workspaceTitle').textContent = 'PDF to Word';
                    document.getElementById('toolContent').innerHTML = `
                        <div class="info-box warning">
                            <strong>Experimental:</strong> Text extraction only. Formatting and images will be lost.
                        </div>

                        <div class="upload-zone" id="pdfToWordUploadZone">
                            <input type="file" id="pdfToWordFileInput" accept=".pdf">
                            <div class="upload-icon">üìÅ</div>
                            <div class="upload-text">Drop PDF file here or click to browse</div>
                            <div class="upload-hint">Upload a PDF file ‚Ä¢ Max 50MB</div>
                        </div>

                        <div class="file-list" id="pdfToWordFileList"></div>
                    `;

                    const uploadZone = document.getElementById('pdfToWordUploadZone');
                    const fileInput = document.getElementById('pdfToWordFileInput');

                    uploadZone.addEventListener('click', () => fileInput.click());
                    fileInput.addEventListener('change', (e) => {
                        if (e.target.files.length > 0) {
                            Utils.showSuccess('File uploaded successfully! Full conversion functionality coming soon.');
                        }
                    });
                }
            },

            'word-to-pdf': {
                init() {
                    document.getElementById('workspaceTitle').textContent = 'Word to PDF';
                    document.getElementById('toolContent').innerHTML = `
                        <div class="info-box warning">
                            <strong>Coming Soon:</strong> Word to PDF conversion requires advanced libraries for proper formatting preservation.
                        </div>

                        <div class="upload-zone" id="wordToPdfUploadZone">
                            <input type="file" id="wordToPdfFileInput" accept=".docx,.doc">
                            <div class="upload-icon">üìÅ</div>
                            <div class="upload-text">Drop Word file here or click to browse</div>
                            <div class="upload-hint">Upload .DOCX file ‚Ä¢ Max 50MB</div>
                        </div>

                        <div class="file-list" id="wordToPdfFileList"></div>
                    `;

                    const uploadZone = document.getElementById('wordToPdfUploadZone');
                    const fileInput = document.getElementById('wordToPdfFileInput');

                    uploadZone.addEventListener('click', () => fileInput.click());
                    fileInput.addEventListener('change', (e) => {
                        if (e.target.files.length > 0) {
                            Utils.showSuccess('File uploaded successfully! Full conversion functionality coming soon.');
                        }
                    });
                }
            },

            'jpg-to-pdf': {
                files: [],

                init() {
                    this.files = [];

                    document.getElementById('workspaceTitle').textContent = 'JPG to PDF';
                    document.getElementById('toolContent').innerHTML = `
                        <div class="info-box info">
                            <strong>Convert images to PDF:</strong> Upload one or more images (JPG, PNG, WEBP) and combine them into a single PDF file.
                        </div>

                        <div class="upload-zone" id="jpgToPdfUploadZone">
                            <input type="file" id="jpgToPdfFileInput" accept="image/*" multiple>
                            <div class="upload-icon">üñºÔ∏è</div>
                            <div class="upload-text">Drop image files here or click to browse</div>
                            <div class="upload-hint">Upload JPG, PNG, WEBP ‚Ä¢ Max 50MB each ‚Ä¢ Multiple files allowed</div>
                        </div>

                        <div class="file-list" id="jpgToPdfFileList"></div>

                        <div class="action-buttons" id="jpgToPdfActions" style="display: none;">
                            <button class="primary-btn" id="convertToPdfBtn">Convert to PDF</button>
                        </div>
                    `;

                    const uploadZone = document.getElementById('jpgToPdfUploadZone');
                    const fileInput = document.getElementById('jpgToPdfFileInput');

                    uploadZone.addEventListener('click', () => fileInput.click());
                    fileInput.addEventListener('change', (e) => this.handleFiles(e.target.files));

                    uploadZone.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        uploadZone.classList.add('dragover');
                    });

                    uploadZone.addEventListener('dragleave', () => {
                        uploadZone.classList.remove('dragover');
                    });

                    uploadZone.addEventListener('drop', (e) => {
                        e.preventDefault();
                        uploadZone.classList.remove('dragover');
                        this.handleFiles(e.dataTransfer.files);
                    });

                    document.getElementById('convertToPdfBtn').addEventListener('click', () => this.convert());
                },

                handleFiles(fileList) {
                    const validFiles = Array.from(fileList).filter(file => {
                        if (!CONFIG.supportedFormats.images.includes(file.type)) {
                            Utils.showError(`${file.name}: Invalid file type. Only JPG, PNG, WEBP allowed.`);
                            return false;
                        }
                        if (file.size > CONFIG.maxFileSize) {
                            Utils.showError(`${file.name}: File too large (max 50MB)`);
                            return false;
                        }
                        return true;
                    });

                    if (validFiles.length === 0) return;

                    this.files.push(...validFiles);
                    this.renderFileList();
                },

                renderFileList() {
                    const listEl = document.getElementById('jpgToPdfFileList');
                    const convertBtn = document.getElementById('jpgToPdfActions');

                    if (this.files.length === 0) {
                        listEl.innerHTML = '';
                        convertBtn.style.display = 'none';
                        return;
                    }

                    convertBtn.style.display = 'flex';

                    listEl.innerHTML = this.files.map((file, index) => `
                        <div class="file-item" data-index="${index}">
                            <div class="file-info">
                                <div class="file-icon">üñºÔ∏è</div>
                                <div>
                                    <div class="file-name">${file.name}</div>
                                    <div class="file-size">${Utils.formatFileSize(file.size)}</div>
                                </div>
                            </div>
                            <button class="file-remove" onclick="Tools['jpg-to-pdf'].removeFile(${index})">Remove</button>
                        </div>
                    `).join('');
                },

                removeFile(index) {
                    this.files.splice(index, 1);
                    this.renderFileList();
                },

                async convert() {
                    if (this.files.length === 0) {
                        alert('Please upload at least one image');
                        return;
                    }

                    try {
                        UIManager.showLoading('Converting to PDF...');
                        Utils.showProgress(0, 'Creating PDF document...');

                        const { PDFDocument } = PDFLib;
                        const pdfDoc = await PDFDocument.create();

                        for (let i = 0; i < this.files.length; i++) {
                            const progress = ((i + 1) / this.files.length) * 100;
                            Utils.showProgress(progress, `Adding image ${i + 1} of ${this.files.length}...`);

                            const arrayBuffer = await Utils.fileToArrayBuffer(this.files[i]);
                            let image;

                            if (this.files[i].type === 'image/png') {
                                image = await pdfDoc.embedPng(arrayBuffer);
                            } else if (this.files[i].type === 'image/jpeg' || this.files[i].type === 'image/jpg') {
                                image = await pdfDoc.embedJpg(arrayBuffer);
                            } else {
                                // Convert other formats to PNG using canvas
                                const dataUrl = await Utils.fileToDataURL(this.files[i]);
                                const img = await new Promise((resolve, reject) => {
                                    const imgEl = new Image();
                                    imgEl.onload = () => resolve(imgEl);
                                    imgEl.onerror = reject;
                                    imgEl.src = dataUrl;
                                });

                                const canvas = document.createElement('canvas');
                                canvas.width = img.width;
                                canvas.height = img.height;
                                const ctx = canvas.getContext('2d');
                                ctx.drawImage(img, 0, 0);

                                const pngBlob = await new Promise(resolve => {
                                    canvas.toBlob(resolve, 'image/png');
                                });

                                const pngArrayBuffer = await pngBlob.arrayBuffer();
                                image = await pdfDoc.embedPng(pngArrayBuffer);
                            }

                            // Create page with image dimensions
                            const page = pdfDoc.addPage([image.width, image.height]);
                            page.drawImage(image, {
                                x: 0,
                                y: 0,
                                width: image.width,
                                height: image.height
                            });
                        }

                        Utils.showProgress(100, 'Saving PDF...');
                        const pdfBytes = await pdfDoc.save();
                        const blob = new Blob([pdfBytes], { type: 'application/pdf' });

                        const resultsSection = document.getElementById('resultsSection');
                        resultsSection.style.display = 'block';
                        resultsSection.innerHTML = `
                            <div class="result-item">
                                <div class="result-info">
                                    <div class="result-details">
                                        <div class="result-name">images-to-pdf.pdf</div>
                                        <div class="result-stats">
                                            ${this.files.length} image${this.files.length > 1 ? 's' : ''} converted ‚Ä¢ ${Utils.formatFileSize(blob.size)}
                                        </div>
                                    </div>
                                    <button class="download-btn" onclick="Tools['jpg-to-pdf'].downloadResult()">Download PDF</button>
                                </div>
                            </div>
                        `;

                        this.resultBlob = blob;
                        Utils.showSuccess(`Successfully converted ${this.files.length} image${this.files.length > 1 ? 's' : ''} to PDF!`);
                        UIManager.hideLoading();
                        Utils.hideProgress();

                    } catch (error) {
                        console.error('Conversion error:', error);
                        Utils.showError('Failed to convert images to PDF. Please try again.');
                        UIManager.hideLoading();
                        Utils.hideProgress();
                    }
                },

                downloadResult() {
                    if (this.resultBlob) {
                        Utils.downloadFile(this.resultBlob, 'images-to-pdf.pdf');
                    }
                }
            },

            'pdf-to-jpg': {
                currentFile: null,
                pdfData: null,
                convertedImages: [],

                init() {
                    this.currentFile = null;
                    this.pdfData = null;
                    this.convertedImages = [];

                    document.getElementById('workspaceTitle').textContent = 'PDF to JPG';
                    document.getElementById('toolContent').innerHTML = `
                        <div class="info-box info">
                            <strong>Convert PDF pages to images:</strong> Each page will be exported as a separate high-quality JPG image.
                        </div>

                        <div class="tool-settings">
                            <div class="setting-group">
                                <label class="setting-label">Image Quality</label>
                                <input type="range" id="jpgQuality" min="50" max="100" value="92" class="setting-input">
                                <span id="qualityValue" style="color: #666;">92%</span>
                            </div>
                            <div class="setting-group">
                                <label class="setting-label">Scale</label>
                                <select id="jpgScale" class="setting-input" style="background: rgba(255,255,255,0.1); color: #333;">
                                    <option value="1">1x (Standard)</option>
                                    <option value="1.5">1.5x (High)</option>
                                    <option value="2" selected>2x (Best)</option>
                                    <option value="3">3x (Ultra)</option>
                                </select>
                            </div>
                        </div>

                        <div class="upload-zone" id="pdfToJpgUploadZone">
                            <input type="file" id="pdfToJpgFileInput" accept=".pdf">
                            <div class="upload-icon">üìÅ</div>
                            <div class="upload-text">Drop PDF file here or click to browse</div>
                            <div class="upload-hint">Upload a PDF file ‚Ä¢ Max 50MB</div>
                        </div>

                        <div class="file-list" id="pdfToJpgFileList"></div>

                        <div class="action-buttons" id="pdfToJpgActions" style="display: none;">
                            <button class="primary-btn" id="convertToJpgBtn">Convert to JPG</button>
                        </div>
                    `;

                    const uploadZone = document.getElementById('pdfToJpgUploadZone');
                    const fileInput = document.getElementById('pdfToJpgFileInput');
                    const qualitySlider = document.getElementById('jpgQuality');

                    qualitySlider.addEventListener('input', (e) => {
                        document.getElementById('qualityValue').textContent = e.target.value + '%';
                    });

                    uploadZone.addEventListener('click', () => fileInput.click());
                    fileInput.addEventListener('change', (e) => this.handleFile(e.target.files[0]));

                    uploadZone.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        uploadZone.classList.add('dragover');
                    });

                    uploadZone.addEventListener('dragleave', () => {
                        uploadZone.classList.remove('dragover');
                    });

                    uploadZone.addEventListener('drop', (e) => {
                        e.preventDefault();
                        uploadZone.classList.remove('dragover');
                        if (e.dataTransfer.files.length > 0) {
                            this.handleFile(e.dataTransfer.files[0]);
                        }
                    });

                    document.getElementById('convertToJpgBtn').addEventListener('click', () => this.convert());
                },

                async handleFile(file) {
                    if (!file || !Utils.validateFile(file, 'pdf')) return;

                    this.currentFile = file;
                    UIManager.showLoading('Loading PDF...');

                    try {
                        this.pdfData = await Utils.fileToArrayBuffer(file);
                        const pdf = await pdfjsLib.getDocument({ data: this.pdfData }).promise;

                        document.getElementById('pdfToJpgFileList').innerHTML = `
                            <div class="file-item">
                                <div class="file-info">
                                    <div class="file-icon">üìÑ</div>
                                    <div>
                                        <div class="file-name">${file.name}</div>
                                        <div class="file-size">${Utils.formatFileSize(file.size)} ‚Ä¢ ${pdf.numPages} pages</div>
                                    </div>
                                </div>
                            </div>
                        `;

                        document.getElementById('pdfToJpgActions').style.display = 'flex';
                        UIManager.hideLoading();

                    } catch (error) {
                        console.error('Error loading PDF:', error);
                        Utils.showError('Failed to load PDF. Please try again.');
                        UIManager.hideLoading();
                    }
                },

                async convert() {
                    if (!this.pdfData) return;

                    try {
                        UIManager.showLoading('Converting to JPG...');
                        Utils.showProgress(0, 'Loading PDF...');

                        const pdf = await pdfjsLib.getDocument({ data: this.pdfData }).promise;
                        const numPages = pdf.numPages;
                        this.convertedImages = [];

                        const quality = parseInt(document.getElementById('jpgQuality').value) / 100;
                        const scale = parseFloat(document.getElementById('jpgScale').value);

                        for (let pageNum = 1; pageNum <= numPages; pageNum++) {
                            const progress = (pageNum / numPages) * 100;
                            Utils.showProgress(progress, `Converting page ${pageNum} of ${numPages}...`);

                            const page = await pdf.getPage(pageNum);
                            const viewport = page.getViewport({ scale });

                            const canvas = document.createElement('canvas');
                            canvas.width = viewport.width;
                            canvas.height = viewport.height;

                            const context = canvas.getContext('2d');
                            await page.render({ canvasContext: context, viewport }).promise;

                            const blob = await new Promise(resolve => {
                                canvas.toBlob(resolve, 'image/jpeg', quality);
                            });

                            this.convertedImages.push({
                                blob,
                                pageNum,
                                name: `page-${pageNum}.jpg`
                            });
                        }

                        Utils.showProgress(100, 'Finalizing...');

                        // Show results
                        const resultsSection = document.getElementById('resultsSection');
                        resultsSection.style.display = 'block';
                        resultsSection.innerHTML = `
                            <div style="margin-bottom: 20px;">
                                <button class="success-btn" onclick="Tools['pdf-to-jpg'].downloadAll()" style="width: 100%;">
                                    Download All Images (ZIP)
                                </button>
                            </div>
                            ${this.convertedImages.map((img, index) => `
                                <div class="result-item">
                                    <div class="result-info">
                                        <div class="result-details">
                                            <div class="result-name">${img.name}</div>
                                            <div class="result-stats">${Utils.formatFileSize(img.blob.size)}</div>
                                        </div>
                                        <button class="download-btn" onclick="Tools['pdf-to-jpg'].downloadSingle(${index})">Download</button>
                                    </div>
                                </div>
                            `).join('')}
                        `;

                        Utils.showSuccess(`Successfully converted ${numPages} page${numPages > 1 ? 's' : ''} to JPG!`);
                        UIManager.hideLoading();
                        Utils.hideProgress();

                    } catch (error) {
                        console.error('Conversion error:', error);
                        Utils.showError('Failed to convert PDF to JPG. Please try again.');
                        UIManager.hideLoading();
                        Utils.hideProgress();
                    }
                },

                downloadSingle(index) {
                    const img = this.convertedImages[index];
                    Utils.downloadFile(img.blob, img.name);
                },

                async downloadAll() {
                    if (this.convertedImages.length === 0) return;

                    try {
                        UIManager.showLoading('Creating ZIP file...');

                        const zip = new JSZip();
                        this.convertedImages.forEach(img => {
                            zip.file(img.name, img.blob);
                        });

                        const zipBlob = await zip.generateAsync({ type: 'blob' });
                        Utils.downloadFile(zipBlob, 'pdf-pages.zip');

                        UIManager.hideLoading();

                    } catch (error) {
                        console.error('ZIP error:', error);
                        Utils.showError('Failed to create ZIP file.');
                        UIManager.hideLoading();
                    }
                }
            },

            'rotate': {
                currentFile: null,
                pdfData: null,
                totalPages: 0,
                pageRotations: {},

                init() {
                    this.currentFile = null;
                    this.pdfData = null;
                    this.totalPages = 0;
                    this.pageRotations = {};

                    document.getElementById('workspaceTitle').textContent = 'Rotate PDF';
                    document.getElementById('toolContent').innerHTML = `
                        <div class="info-box info">
                            <strong>Rotate PDF pages:</strong> Click on page thumbnails to rotate them. Each click rotates 90¬∞ clockwise.
                        </div>

                        <div class="upload-zone" id="rotateUploadZone">
                            <input type="file" id="rotateFileInput" accept=".pdf">
                            <div class="upload-icon">üìÅ</div>
                            <div class="upload-text">Drop PDF file here or click to browse</div>
                            <div class="upload-hint">Upload a PDF file ‚Ä¢ Max 50MB</div>
                        </div>

                        <div class="file-list" id="rotateFileList"></div>

                        <div id="rotatePagesContainer" style="display: none;">
                            <div style="margin: 20px 0; display: flex; gap: 10px; flex-wrap: wrap;">
                                <button class="secondary-btn" style="padding: 10px 20px;" onclick="Tools.rotate.rotateAll(90)">Rotate All 90¬∞ ‚Üª</button>
                                <button class="secondary-btn" style="padding: 10px 20px;" onclick="Tools.rotate.rotateAll(180)">Rotate All 180¬∞ ‚Üª‚Üª</button>
                                <button class="secondary-btn" style="padding: 10px 20px;" onclick="Tools.rotate.rotateAll(270)">Rotate All 270¬∞ ‚Ü∫</button>
                                <button class="secondary-btn" style="padding: 10px 20px;" onclick="Tools.rotate.resetRotations()">Reset All</button>
                            </div>
                            <div class="page-thumbnails" id="rotatePageThumbnails"></div>
                            <div class="action-buttons">
                                <button class="primary-btn" id="saveRotatedBtn">Save Rotated PDF</button>
                            </div>
                        </div>
                    `;

                    const uploadZone = document.getElementById('rotateUploadZone');
                    const fileInput = document.getElementById('rotateFileInput');

                    uploadZone.addEventListener('click', () => fileInput.click());
                    fileInput.addEventListener('change', (e) => this.handleFile(e.target.files[0]));

                    uploadZone.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        uploadZone.classList.add('dragover');
                    });

                    uploadZone.addEventListener('dragleave', () => {
                        uploadZone.classList.remove('dragover');
                    });

                    uploadZone.addEventListener('drop', (e) => {
                        e.preventDefault();
                        uploadZone.classList.remove('dragover');
                        if (e.dataTransfer.files.length > 0) {
                            this.handleFile(e.dataTransfer.files[0]);
                        }
                    });

                    document.getElementById('saveRotatedBtn').addEventListener('click', () => this.saveRotated());
                },

                async handleFile(file) {
                    if (!file || !Utils.validateFile(file, 'pdf')) return;

                    this.currentFile = file;
                    this.pageRotations = {};
                    UIManager.showLoading('Loading PDF pages...');

                    try {
                        this.pdfData = await Utils.fileToArrayBuffer(file);
                        const pdf = await pdfjsLib.getDocument({ data: this.pdfData }).promise;
                        this.totalPages = pdf.numPages;

                        document.getElementById('rotateFileList').innerHTML = `
                            <div class="file-item">
                                <div class="file-info">
                                    <div class="file-icon">üìÑ</div>
                                    <div>
                                        <div class="file-name">${file.name}</div>
                                        <div class="file-size">${Utils.formatFileSize(file.size)} ‚Ä¢ ${this.totalPages} pages</div>
                                    </div>
                                </div>
                            </div>
                        `;

                        await this.renderThumbnails();
                        document.getElementById('rotatePagesContainer').style.display = 'block';
                        UIManager.hideLoading();

                    } catch (error) {
                        console.error('Error loading PDF:', error);
                        Utils.showError('Failed to load PDF. Please try again.');
                        UIManager.hideLoading();
                    }
                },

                async renderThumbnails() {
                    const container = document.getElementById('rotatePageThumbnails');
                    container.innerHTML = '';

                    for (let i = 1; i <= this.totalPages; i++) {
                        const thumbnail = document.createElement('div');
                        thumbnail.className = 'page-thumbnail';
                        thumbnail.setAttribute('data-page', i);
                        thumbnail.innerHTML = `
                            <canvas></canvas>
                            <div class="page-number">Page ${i} <span id="rotation-${i}"></span></div>
                        `;

                        thumbnail.addEventListener('click', () => this.rotatePage(i));
                        container.appendChild(thumbnail);

                        const canvas = thumbnail.querySelector('canvas');
                        await Utils.renderPDFThumbnail(this.pdfData, i, canvas, 0.5);
                    }
                },

                rotatePage(pageNum) {
                    if (!this.pageRotations[pageNum]) {
                        this.pageRotations[pageNum] = 0;
                    }

                    this.pageRotations[pageNum] = (this.pageRotations[pageNum] + 90) % 360;
                    this.updatePageDisplay(pageNum);
                },

                updatePageDisplay(pageNum) {
                    const rotation = this.pageRotations[pageNum] || 0;
                    const thumbnail = document.querySelector(`[data-page="${pageNum}"]`);
                    const canvas = thumbnail.querySelector('canvas');
                    const rotationText = document.getElementById(`rotation-${pageNum}`);

                    canvas.style.transform = `rotate(${rotation}deg)`;
                    rotationText.textContent = rotation > 0 ? `(${rotation}¬∞)` : '';
                },

                rotateAll(degrees) {
                    for (let i = 1; i <= this.totalPages; i++) {
                        if (!this.pageRotations[i]) {
                            this.pageRotations[i] = 0;
                        }
                        this.pageRotations[i] = (this.pageRotations[i] + degrees) % 360;
                        this.updatePageDisplay(i);
                    }
                },

                resetRotations() {
                    this.pageRotations = {};
                    for (let i = 1; i <= this.totalPages; i++) {
                        this.updatePageDisplay(i);
                    }
                },

                async saveRotated() {
                    try {
                        UIManager.showLoading('Rotating PDF...');
                        Utils.showProgress(0, 'Loading PDF...');

                        const { PDFDocument, degrees } = PDFLib;
                        const pdfDoc = await PDFDocument.load(this.pdfData);
                        const pages = pdfDoc.getPages();

                        Utils.showProgress(50, 'Applying rotations...');

                        pages.forEach((page, index) => {
                            const pageNum = index + 1;
                            const rotation = this.pageRotations[pageNum] || 0;

                            if (rotation > 0) {
                                const currentRotation = page.getRotation().angle;
                                page.setRotation(degrees(currentRotation + rotation));
                            }
                        });

                        Utils.showProgress(100, 'Saving PDF...');
                        const pdfBytes = await pdfDoc.save();
                        const blob = new Blob([pdfBytes], { type: 'application/pdf' });

                        const rotatedCount = Object.keys(this.pageRotations).filter(k => this.pageRotations[k] > 0).length;

                        const resultsSection = document.getElementById('resultsSection');
                        resultsSection.style.display = 'block';
                        resultsSection.innerHTML = `
                            <div class="result-item">
                                <div class="result-info">
                                    <div class="result-details">
                                        <div class="result-name">rotated-${this.currentFile.name}</div>
                                        <div class="result-stats">
                                            ${rotatedCount} page${rotatedCount !== 1 ? 's' : ''} rotated ‚Ä¢ ${Utils.formatFileSize(blob.size)}
                                        </div>
                                    </div>
                                    <button class="download-btn" onclick="Tools.rotate.downloadResult()">Download PDF</button>
                                </div>
                            </div>
                        `;

                        this.resultBlob = blob;
                        Utils.showSuccess('PDF rotated successfully!');
                        UIManager.hideLoading();
                        Utils.hideProgress();

                    } catch (error) {
                        console.error('Rotation error:', error);
                        Utils.showError('Failed to rotate PDF. Please try again.');
                        UIManager.hideLoading();
                        Utils.hideProgress();
                    }
                },

                downloadResult() {
                    if (this.resultBlob && this.currentFile) {
                        Utils.downloadFile(this.resultBlob, `rotated-${this.currentFile.name}`);
                    }
                }
            },

            'protect': {
                init() {
                    document.getElementById('workspaceTitle').textContent = 'Protect PDF';
                    document.getElementById('toolContent').innerHTML = `
                        <div class="info-box warning">
                            <strong>Basic protection:</strong> Adds password protection (128-bit). For maximum security, use Adobe Acrobat.
                        </div>

                        <div class="upload-zone" id="protectUploadZone">
                            <input type="file" id="protectFileInput" accept=".pdf">
                            <div class="upload-icon">üìÅ</div>
                            <div class="upload-text">Drop PDF file here or click to browse</div>
                            <div class="upload-hint">Upload a PDF file ‚Ä¢ Max 50MB</div>
                        </div>

                        <div class="file-list" id="protectFileList"></div>
                    `;

                    const uploadZone = document.getElementById('protectUploadZone');
                    const fileInput = document.getElementById('protectFileInput');

                    uploadZone.addEventListener('click', () => fileInput.click());
                    fileInput.addEventListener('change', (e) => {
                        if (e.target.files.length > 0) {
                            Utils.showSuccess('File uploaded successfully! Full protect functionality coming soon.');
                        }
                    });
                }
            },

            'unlock': {
                init() {
                    document.getElementById('workspaceTitle').textContent = 'Unlock PDF';
                    document.getElementById('toolContent').innerHTML = `
                        <div class="info-box info">
                            <strong>Remove password protection:</strong> Upload a password-protected PDF and enter the password to unlock it.
                        </div>

                        <div class="upload-zone" id="unlockUploadZone">
                            <input type="file" id="unlockFileInput" accept=".pdf">
                            <div class="upload-icon">üìÅ</div>
                            <div class="upload-text">Drop PDF file here or click to browse</div>
                            <div class="upload-hint">Upload a password-protected PDF ‚Ä¢ Max 50MB</div>
                        </div>

                        <div class="file-list" id="unlockFileList"></div>
                    `;

                    const uploadZone = document.getElementById('unlockUploadZone');
                    const fileInput = document.getElementById('unlockFileInput');

                    uploadZone.addEventListener('click', () => fileInput.click());
                    fileInput.addEventListener('change', (e) => {
                        if (e.target.files.length > 0) {
                            Utils.showSuccess('File uploaded successfully! Full unlock functionality coming soon.');
                        }
                    });
                }
            },

            'watermark': {
                currentFile: null,

                init() {
                    this.currentFile = null;

                    document.getElementById('workspaceTitle').textContent = 'Add Watermark';
                    document.getElementById('toolContent').innerHTML = `
                        <div class="info-box info">
                            <strong>Add text watermark:</strong> Customize the text, position, opacity, size, and rotation of your watermark.
                        </div>

                        <div class="tool-settings">
                            <div class="setting-group">
                                <label class="setting-label">Watermark Text</label>
                                <input type="text" id="watermarkText" class="setting-input" placeholder="CONFIDENTIAL" value="CONFIDENTIAL">
                            </div>
                            <div class="setting-group">
                                <label class="setting-label">Font Size</label>
                                <input type="range" id="watermarkSize" min="20" max="100" value="48" class="setting-input">
                                <span id="sizeValue" style="color: #666;">48px</span>
                            </div>
                            <div class="setting-group">
                                <label class="setting-label">Opacity</label>
                                <input type="range" id="watermarkOpacity" min="10" max="100" value="30" class="setting-input">
                                <span id="opacityValue" style="color: #666;">30%</span>
                            </div>
                            <div class="setting-group">
                                <label class="setting-label">Rotation</label>
                                <input type="range" id="watermarkRotation" min="0" max="360" value="45" class="setting-input">
                                <span id="rotationValue" style="color: #666;">45¬∞</span>
                            </div>
                            <div class="setting-group">
                                <label class="setting-label">Position</label>
                                <select id="watermarkPosition" class="setting-input" style="background: rgba(255,255,255,0.1); color: #333;">
                                    <option value="center" selected>Center</option>
                                    <option value="diagonal">Diagonal</option>
                                    <option value="top">Top</option>
                                    <option value="bottom">Bottom</option>
                                </select>
                            </div>
                        </div>

                        <div class="upload-zone" id="watermarkUploadZone">
                            <input type="file" id="watermarkFileInput" accept=".pdf">
                            <div class="upload-icon">üìÅ</div>
                            <div class="upload-text">Drop PDF file here or click to browse</div>
                            <div class="upload-hint">Upload a PDF file ‚Ä¢ Max 50MB</div>
                        </div>

                        <div class="file-list" id="watermarkFileList"></div>

                        <div class="action-buttons" id="watermarkActions" style="display: none;">
                            <button class="primary-btn" id="addWatermarkBtn">Add Watermark</button>
                        </div>
                    `;

                    const uploadZone = document.getElementById('watermarkUploadZone');
                    const fileInput = document.getElementById('watermarkFileInput');

                    // Update value displays
                    document.getElementById('watermarkSize').addEventListener('input', (e) => {
                        document.getElementById('sizeValue').textContent = e.target.value + 'px';
                    });
                    document.getElementById('watermarkOpacity').addEventListener('input', (e) => {
                        document.getElementById('opacityValue').textContent = e.target.value + '%';
                    });
                    document.getElementById('watermarkRotation').addEventListener('input', (e) => {
                        document.getElementById('rotationValue').textContent = e.target.value + '¬∞';
                    });

                    uploadZone.addEventListener('click', () => fileInput.click());
                    fileInput.addEventListener('change', (e) => this.handleFile(e.target.files[0]));

                    uploadZone.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        uploadZone.classList.add('dragover');
                    });

                    uploadZone.addEventListener('dragleave', () => {
                        uploadZone.classList.remove('dragover');
                    });

                    uploadZone.addEventListener('drop', (e) => {
                        e.preventDefault();
                        uploadZone.classList.remove('dragover');
                        if (e.dataTransfer.files.length > 0) {
                            this.handleFile(e.dataTransfer.files[0]);
                        }
                    });

                    document.getElementById('addWatermarkBtn').addEventListener('click', () => this.addWatermark());
                },

                handleFile(file) {
                    if (!file || !Utils.validateFile(file, 'pdf')) return;

                    this.currentFile = file;

                    document.getElementById('watermarkFileList').innerHTML = `
                        <div class="file-item">
                            <div class="file-info">
                                <div class="file-icon">üìÑ</div>
                                <div>
                                    <div class="file-name">${file.name}</div>
                                    <div class="file-size">${Utils.formatFileSize(file.size)}</div>
                                </div>
                            </div>
                        </div>
                    `;

                    document.getElementById('watermarkActions').style.display = 'flex';
                },

                async addWatermark() {
                    if (!this.currentFile) return;

                    const watermarkText = document.getElementById('watermarkText').value;
                    if (!watermarkText.trim()) {
                        alert('Please enter watermark text');
                        return;
                    }

                    try {
                        UIManager.showLoading('Adding watermark...');
                        Utils.showProgress(0, 'Loading PDF...');

                        const arrayBuffer = await Utils.fileToArrayBuffer(this.currentFile);
                        const { PDFDocument, rgb, degrees } = PDFLib;
                        const pdfDoc = await PDFDocument.load(arrayBuffer);
                        const pages = pdfDoc.getPages();

                        const fontSize = parseInt(document.getElementById('watermarkSize').value);
                        const opacity = parseInt(document.getElementById('watermarkOpacity').value) / 100;
                        const rotation = parseInt(document.getElementById('watermarkRotation').value);
                        const position = document.getElementById('watermarkPosition').value;

                        Utils.showProgress(30, 'Adding watermark to pages...');

                        for (let i = 0; i < pages.length; i++) {
                            const progress = 30 + ((i + 1) / pages.length) * 60;
                            Utils.showProgress(progress, `Watermarking page ${i + 1} of ${pages.length}...`);

                            const page = pages[i];
                            const { width, height } = page.getSize();

                            let x, y;
                            switch (position) {
                                case 'center':
                                    x = width / 2;
                                    y = height / 2;
                                    break;
                                case 'diagonal':
                                    x = width / 2;
                                    y = height / 2;
                                    break;
                                case 'top':
                                    x = width / 2;
                                    y = height - 50;
                                    break;
                                case 'bottom':
                                    x = width / 2;
                                    y = 50;
                                    break;
                                default:
                                    x = width / 2;
                                    y = height / 2;
                            }

                            page.drawText(watermarkText, {
                                x: x,
                                y: y,
                                size: fontSize,
                                rotate: degrees(rotation),
                                color: rgb(0.5, 0.5, 0.5),
                                opacity: opacity
                            });
                        }

                        Utils.showProgress(100, 'Saving PDF...');
                        const pdfBytes = await pdfDoc.save();
                        const blob = new Blob([pdfBytes], { type: 'application/pdf' });

                        const resultsSection = document.getElementById('resultsSection');
                        resultsSection.style.display = 'block';
                        resultsSection.innerHTML = `
                            <div class="result-item">
                                <div class="result-info">
                                    <div class="result-details">
                                        <div class="result-name">watermarked-${this.currentFile.name}</div>
                                        <div class="result-stats">
                                            Watermark added to ${pages.length} page${pages.length > 1 ? 's' : ''} ‚Ä¢ ${Utils.formatFileSize(blob.size)}
                                        </div>
                                    </div>
                                    <button class="download-btn" onclick="Tools.watermark.downloadResult()">Download PDF</button>
                                </div>
                            </div>
                        `;

                        this.resultBlob = blob;
                        Utils.showSuccess('Watermark added successfully!');
                        UIManager.hideLoading();
                        Utils.hideProgress();

                    } catch (error) {
                        console.error('Watermark error:', error);
                        Utils.showError('Failed to add watermark. Please try again.');
                        UIManager.hideLoading();
                        Utils.hideProgress();
                    }
                },

                downloadResult() {
                    if (this.resultBlob && this.currentFile) {
                        Utils.downloadFile(this.resultBlob, `watermarked-${this.currentFile.name}`);
                    }
                }
            },

            'sign': {
                init() {
                    document.getElementById('workspaceTitle').textContent = 'Sign PDF';
                    document.getElementById('toolContent').innerHTML = `
                        <div class="info-box info">
                            <strong>Digital signature:</strong> Draw your signature or upload an image, then place it on the PDF.
                        </div>

                        <div class="upload-zone" id="signUploadZone">
                            <input type="file" id="signFileInput" accept=".pdf">
                            <div class="upload-icon">üìÅ</div>
                            <div class="upload-text">Drop PDF file here or click to browse</div>
                            <div class="upload-hint">Upload a PDF file ‚Ä¢ Max 50MB</div>
                        </div>

                        <div class="file-list" id="signFileList"></div>
                    `;

                    const uploadZone = document.getElementById('signUploadZone');
                    const fileInput = document.getElementById('signFileInput');

                    uploadZone.addEventListener('click', () => fileInput.click());
                    fileInput.addEventListener('change', (e) => {
                        if (e.target.files.length > 0) {
                            Utils.showSuccess('File uploaded successfully! Full signature functionality coming soon.');
                        }
                    });
                }
            },

            'edit': {
                init() {
                    document.getElementById('workspaceTitle').textContent = 'Edit PDF';
                    document.getElementById('toolContent').innerHTML = `
                        <div class="info-box warning">
                            <strong>Limited editing:</strong> Can add new text and images, but cannot modify existing PDF content.
                        </div>

                        <div class="upload-zone" id="editUploadZone">
                            <input type="file" id="editFileInput" accept=".pdf">
                            <div class="upload-icon">üìÅ</div>
                            <div class="upload-text">Drop PDF file here or click to browse</div>
                            <div class="upload-hint">Upload a PDF file ‚Ä¢ Max 50MB</div>
                        </div>

                        <div class="file-list" id="editFileList"></div>
                    `;

                    const uploadZone = document.getElementById('editUploadZone');
                    const fileInput = document.getElementById('editFileInput');

                    uploadZone.addEventListener('click', () => fileInput.click());
                    fileInput.addEventListener('change', (e) => {
                        if (e.target.files.length > 0) {
                            Utils.showSuccess('File uploaded successfully! Full editing functionality coming soon.');
                        }
                    });
                }
            },

            'ocr': {
                init() {
                    document.getElementById('workspaceTitle').textContent = 'OCR Scanner';
                    document.getElementById('toolContent').innerHTML = `
                        <div class="info-box warning">
                            <strong>Processing time:</strong> OCR is intensive and may take 1-2 minutes per page. Please be patient.
                        </div>

                        <div class="upload-zone" id="ocrUploadZone">
                            <input type="file" id="ocrFileInput" accept=".pdf,image/*">
                            <div class="upload-icon">üìÅ</div>
                            <div class="upload-text">Drop PDF or image file here or click to browse</div>
                            <div class="upload-hint">Upload PDF or image ‚Ä¢ Max 50MB</div>
                        </div>

                        <div class="file-list" id="ocrFileList"></div>
                    `;

                    const uploadZone = document.getElementById('ocrUploadZone');
                    const fileInput = document.getElementById('ocrFileInput');

                    uploadZone.addEventListener('click', () => fileInput.click());
                    fileInput.addEventListener('change', (e) => {
                        if (e.target.files.length > 0) {
                            Utils.showSuccess('File uploaded successfully! Full OCR functionality coming soon.');
                        }
                    });
                }
            },

            'organize': {
                currentFile: null,
                pdfData: null,
                pageOrder: [],

                init() {
                    this.currentFile = null;
                    this.pdfData = null;
                    this.pageOrder = [];

                    document.getElementById('workspaceTitle').textContent = 'Organize Pages';
                    document.getElementById('toolContent').innerHTML = `
                        <div class="info-box info">
                            <strong>Reorganize pages:</strong> Drag pages to reorder them. Click Delete to remove a page, or Duplicate to add a copy.
                        </div>

                        <div class="upload-zone" id="organizeUploadZone">
                            <input type="file" id="organizeFileInput" accept=".pdf">
                            <div class="upload-icon">üìÅ</div>
                            <div class="upload-text">Drop PDF file here or click to browse</div>
                            <div class="upload-hint">Upload a PDF file ‚Ä¢ Max 50MB</div>
                        </div>

                        <div class="file-list" id="organizeFileList"></div>

                        <div id="organizePagesContainer" style="display: none;">
                            <div style="margin: 20px 0;">
                                <span id="pageCount" style="color: #666; font-weight: 600;"></span>
                            </div>
                            <div class="page-thumbnails" id="organizePageThumbnails"></div>
                            <div class="action-buttons">
                                <button class="primary-btn" id="saveOrganizedBtn">Save Organized PDF</button>
                            </div>
                        </div>
                    `;

                    const uploadZone = document.getElementById('organizeUploadZone');
                    const fileInput = document.getElementById('organizeFileInput');

                    uploadZone.addEventListener('click', () => fileInput.click());
                    fileInput.addEventListener('change', (e) => this.handleFile(e.target.files[0]));

                    uploadZone.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        uploadZone.classList.add('dragover');
                    });

                    uploadZone.addEventListener('dragleave', () => {
                        uploadZone.classList.remove('dragover');
                    });

                    uploadZone.addEventListener('drop', (e) => {
                        e.preventDefault();
                        uploadZone.classList.remove('dragover');
                        if (e.dataTransfer.files.length > 0) {
                            this.handleFile(e.dataTransfer.files[0]);
                        }
                    });

                    document.getElementById('saveOrganizedBtn').addEventListener('click', () => this.saveOrganized());
                },

                async handleFile(file) {
                    if (!file || !Utils.validateFile(file, 'pdf')) return;

                    this.currentFile = file;
                    UIManager.showLoading('Loading PDF pages...');

                    try {
                        this.pdfData = await Utils.fileToArrayBuffer(file);
                        const pdf = await pdfjsLib.getDocument({ data: this.pdfData }).promise;
                        const totalPages = pdf.numPages;

                        this.pageOrder = Array.from({ length: totalPages }, (_, i) => i + 1);

                        document.getElementById('organizeFileList').innerHTML = `
                            <div class="file-item">
                                <div class="file-info">
                                    <div class="file-icon">üìÑ</div>
                                    <div>
                                        <div class="file-name">${file.name}</div>
                                        <div class="file-size">${Utils.formatFileSize(file.size)} ‚Ä¢ ${totalPages} pages</div>
                                    </div>
                                </div>
                            </div>
                        `;

                        await this.renderPages();
                        document.getElementById('organizePagesContainer').style.display = 'block';
                        UIManager.hideLoading();

                    } catch (error) {
                        console.error('Error loading PDF:', error);
                        Utils.showError('Failed to load PDF. Please try again.');
                        UIManager.hideLoading();
                    }
                },

                async renderPages() {
                    const container = document.getElementById('organizePageThumbnails');
                    container.innerHTML = '';

                    for (let i = 0; i < this.pageOrder.length; i++) {
                        const pageNum = this.pageOrder[i];
                        const thumbnail = document.createElement('div');
                        thumbnail.className = 'page-thumbnail';
                        thumbnail.setAttribute('draggable', 'true');
                        thumbnail.setAttribute('data-index', i);
                        thumbnail.innerHTML = `
                            <canvas></canvas>
                            <div class="page-number">Page ${pageNum}</div>
                            <div style="display: flex; gap: 5px; margin-top: 8px;">
                                <button onclick="Tools.organize.duplicatePage(${i})" style="flex: 1; padding: 4px 8px; font-size: 0.8em; background: #43e97b; color: white; border: none; border-radius: 4px; cursor: pointer;">Duplicate</button>
                                <button onclick="Tools.organize.deletePage(${i})" style="flex: 1; padding: 4px 8px; font-size: 0.8em; background: #ff4757; color: white; border: none; border-radius: 4px; cursor: pointer;">Delete</button>
                            </div>
                        `;

                        this.setupDragAndDrop(thumbnail);
                        container.appendChild(thumbnail);

                        const canvas = thumbnail.querySelector('canvas');
                        await Utils.renderPDFThumbnail(this.pdfData, pageNum, canvas, 0.5);
                    }

                    this.updatePageCount();
                },

                setupDragAndDrop(element) {
                    element.addEventListener('dragstart', (e) => {
                        e.dataTransfer.effectAllowed = 'move';
                        e.dataTransfer.setData('text/html', e.target.innerHTML);
                        element.classList.add('dragging');
                    });

                    element.addEventListener('dragend', () => {
                        element.classList.remove('dragging');
                    });

                    element.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        e.dataTransfer.dropEffect = 'move';

                        const afterElement = this.getDragAfterElement(e.clientY);
                        const dragging = document.querySelector('.dragging');
                        const container = document.getElementById('organizePageThumbnails');

                        if (afterElement == null) {
                            container.appendChild(dragging);
                        } else {
                            container.insertBefore(dragging, afterElement);
                        }
                    });

                    element.addEventListener('drop', (e) => {
                        e.preventDefault();
                        this.updatePageOrderFromDOM();
                    });
                },

                getDragAfterElement(y) {
                    const draggableElements = [...document.querySelectorAll('.page-thumbnail:not(.dragging)')];

                    return draggableElements.reduce((closest, child) => {
                        const box = child.getBoundingClientRect();
                        const offset = y - box.top - box.height / 2;

                        if (offset < 0 && offset > closest.offset) {
                            return { offset: offset, element: child };
                        } else {
                            return closest;
                        }
                    }, { offset: Number.NEGATIVE_INFINITY }).element;
                },

                updatePageOrderFromDOM() {
                    const thumbnails = document.querySelectorAll('.page-thumbnail');
                    const newOrder = [];

                    thumbnails.forEach((thumb, index) => {
                        const pageText = thumb.querySelector('.page-number').textContent;
                        const pageNum = parseInt(pageText.replace('Page ', ''));
                        newOrder.push(pageNum);
                        thumb.setAttribute('data-index', index);
                    });

                    this.pageOrder = newOrder;
                    this.updatePageCount();
                },

                duplicatePage(index) {
                    const pageNum = this.pageOrder[index];
                    this.pageOrder.splice(index + 1, 0, pageNum);
                    this.renderPages();
                },

                deletePage(index) {
                    if (this.pageOrder.length === 1) {
                        alert('Cannot delete the last page');
                        return;
                    }
                    this.pageOrder.splice(index, 1);
                    this.renderPages();
                },

                updatePageCount() {
                    document.getElementById('pageCount').textContent =
                        `${this.pageOrder.length} page${this.pageOrder.length > 1 ? 's' : ''} in document`;
                },

                async saveOrganized() {
                    try {
                        UIManager.showLoading('Organizing PDF...');
                        Utils.showProgress(0, 'Loading PDF...');

                        const { PDFDocument } = PDFLib;
                        const sourcePdf = await PDFDocument.load(this.pdfData);
                        const newPdf = await PDFDocument.create();

                        for (let i = 0; i < this.pageOrder.length; i++) {
                            const progress = ((i + 1) / this.pageOrder.length) * 100;
                            Utils.showProgress(progress, `Organizing page ${i + 1} of ${this.pageOrder.length}...`);

                            const [copiedPage] = await newPdf.copyPages(sourcePdf, [this.pageOrder[i] - 1]);
                            newPdf.addPage(copiedPage);
                        }

                        Utils.showProgress(100, 'Saving PDF...');
                        const pdfBytes = await newPdf.save();
                        const blob = new Blob([pdfBytes], { type: 'application/pdf' });

                        const resultsSection = document.getElementById('resultsSection');
                        resultsSection.style.display = 'block';
                        resultsSection.innerHTML = `
                            <div class="result-item">
                                <div class="result-info">
                                    <div class="result-details">
                                        <div class="result-name">organized-${this.currentFile.name}</div>
                                        <div class="result-stats">
                                            ${this.pageOrder.length} page${this.pageOrder.length > 1 ? 's' : ''} organized ‚Ä¢ ${Utils.formatFileSize(blob.size)}
                                        </div>
                                    </div>
                                    <button class="download-btn" onclick="Tools.organize.downloadResult()">Download PDF</button>
                                </div>
                            </div>
                        `;

                        this.resultBlob = blob;
                        Utils.showSuccess('PDF organized successfully!');
                        UIManager.hideLoading();
                        Utils.hideProgress();

                    } catch (error) {
                        console.error('Organize error:', error);
                        Utils.showError('Failed to organize PDF. Please try again.');
                        UIManager.hideLoading();
                        Utils.hideProgress();
                    }
                },

                downloadResult() {
                    if (this.resultBlob && this.currentFile) {
                        Utils.downloadFile(this.resultBlob, `organized-${this.currentFile.name}`);
                    }
                }
            },

            'pdf-to-excel': {
                init() {
                    document.getElementById('workspaceTitle').textContent = 'PDF to Excel';
                    document.getElementById('toolContent').innerHTML = `
                        <div class="info-box warning">
                            <strong>Experimental:</strong> Basic table extraction. Works best with simple, well-structured tables.
                        </div>

                        <div class="upload-zone" id="pdfToExcelUploadZone">
                            <input type="file" id="pdfToExcelFileInput" accept=".pdf">
                            <div class="upload-icon">üìÅ</div>
                            <div class="upload-text">Drop PDF file here or click to browse</div>
                            <div class="upload-hint">Upload a PDF file ‚Ä¢ Max 50MB</div>
                        </div>

                        <div class="file-list" id="pdfToExcelFileList"></div>
                    `;

                    const uploadZone = document.getElementById('pdfToExcelUploadZone');
                    const fileInput = document.getElementById('pdfToExcelFileInput');

                    uploadZone.addEventListener('click', () => fileInput.click());
                    fileInput.addEventListener('change', (e) => {
                        if (e.target.files.length > 0) {
                            Utils.showSuccess('File uploaded successfully! Full conversion functionality coming soon.');
                        }
                    });
                }
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.tool-card').forEach(card => {
                card.addEventListener('click', () => {
                    const toolName = card.dataset.tool;
                    UIManager.activateTool(toolName);
                });
            });

            document.getElementById('backToTools').addEventListener('click', () => {
                UIManager.showToolSelector();
            });

            const urlParams = new URLSearchParams(window.location.search);
            const tool = urlParams.get('tool');
            if (tool && LIBRARY_MAP[tool]) {
                UIManager.activateTool(tool);
            }
        });
    </script>

    <!-- Particle Animation -->
    <script>
    function initParticles() {
        const canvas = document.getElementById('particles-canvas');
        if (!canvas) return;

        const ctx = canvas.getContext('2d');
        let particles = [];
        let animationId;

        function resizeCanvas() {
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
        }

        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.size = Math.random() * 3 + 1;
                this.speedX = Math.random() * 1 - 0.5;
                this.speedY = Math.random() * 1 - 0.5;
                this.opacity = Math.random() * 0.5 + 0.2;

                const colors = [
                    'rgba(102, 126, 234,',
                    'rgba(118, 75, 162,',
                    'rgba(240, 147, 251,',
                    'rgba(67, 233, 123,'
                ];
                this.color = colors[Math.floor(Math.random() * colors.length)];
            }

            update() {
                this.x += this.speedX;
                this.y += this.speedY;

                if (this.x > canvas.width) this.x = 0;
                if (this.x < 0) this.x = canvas.width;
                if (this.y > canvas.height) this.y = 0;
                if (this.y < 0) this.y = canvas.height;
            }

            draw() {
                ctx.fillStyle = this.color + this.opacity + ')';
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function createParticles() {
            const particleCount = Math.min(Math.floor((canvas.width * canvas.height) / 15000), 100);
            particles = [];
            for (let i = 0; i < particleCount; i++) {
                particles.push(new Particle());
            }
        }

        function connectParticles() {
            for (let i = 0; i < particles.length; i++) {
                for (let j = i + 1; j < particles.length; j++) {
                    const dx = particles[i].x - particles[j].x;
                    const dy = particles[i].y - particles[j].y;
                    const distance = Math.sqrt(dx * dx + dy * dy);

                    if (distance < 150) {
                        const opacity = (1 - distance / 150) * 0.2;
                        ctx.strokeStyle = `rgba(102, 126, 234, ${opacity})`;
                        ctx.lineWidth = 1;
                        ctx.beginPath();
                        ctx.moveTo(particles[i].x, particles[i].y);
                        ctx.lineTo(particles[j].x, particles[j].y);
                        ctx.stroke();
                    }
                }
            }
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            particles.forEach(particle => {
                particle.update();
                particle.draw();
            });

            connectParticles();

            animationId = requestAnimationFrame(animate);
        }

        createParticles();
        animate();

        window.addEventListener('beforeunload', () => {
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
        });
    }

    document.addEventListener('DOMContentLoaded', initParticles);
    </script>
</body>

</html>